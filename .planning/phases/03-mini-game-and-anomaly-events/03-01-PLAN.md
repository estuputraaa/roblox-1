---
phase: 03-mini-game-and-anomaly-events
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/ServerScriptService/Services/MiniGameService.lua
  - src/ReplicatedStorage/Shared/Config/MiniGameConfig.lua
  - src/ReplicatedStorage/Shared/Remotes/RemoteNames.lua
autonomous: true
must_haves:
  truths:
    - "Mini-game CookNoodle dan RepairComputer bisa dipanggil eksplisit lewat registry service."
    - "Contract hasil mini-game seragam dan mengembalikan score/success/reward/penalty/tags."
    - "Unknown mini-game id ditolak aman tanpa crash runtime."
  artifacts:
    - path: src/ServerScriptService/Services/MiniGameService.lua
      provides: "Registry handler mini-game + normalisasi result contract."
    - path: src/ReplicatedStorage/Shared/Config/MiniGameConfig.lua
      provides: "Definisi parameter mini-game yang konsisten."
  key_links:
    - from: src/ServerScriptService/Services/MiniGameService.lua
      to: src/ServerScriptService/Services/EconomyManager.lua
      via: "result envelope disalurkan ke economy"
---

<objective>
Membuat kontrak mini-game yang konsisten dan extensible.

Purpose: Menyiapkan fondasi mini-game server-side yang bisa dipakai event runtime.
Output: MiniGameService registry dengan handler berbeda untuk CookNoodle/RepairComputer/AnomalyResponse.
</objective>

<execution_context>
@.claude/get-shit-done/workflows/execute-plan.md
@.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-mini-game-and-anomaly-events/03-CONTEXT.md
@.planning/phases/03-mini-game-and-anomaly-events/03-RESEARCH.md
@src/ServerScriptService/Services/MiniGameService.lua
@src/ReplicatedStorage/Shared/Config/MiniGameConfig.lua
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor MiniGameService jadi registry handler</name>
  <files>src/ServerScriptService/Services/MiniGameService.lua</files>
  <action>Bangun registry internal untuk mini-game id ke handler function. Setiap handler menghasilkan score dan tag dengan profil berbeda (CookNoodle quick-low risk, RepairComputer medium risk, AnomalyResponse high risk). Tambahkan guard jika miniGameId tidak dikenal.</action>
  <verify>Periksa `RunMiniGame` menggunakan jalur registry handler, bukan random generic tunggal.</verify>
  <done>MiniGameService bisa mengeksekusi mini-game berdasarkan handler spesifik.</done>
</task>

<task type="auto">
  <name>Task 2: Normalisasi contract result mini-game</name>
  <files>src/ServerScriptService/Services/MiniGameService.lua, src/ReplicatedStorage/Shared/Config/MiniGameConfig.lua</files>
  <action>Standarkan result object minimal: `miniGameId`, `score`, `success`, `rewardApplied`, `penaltyApplied`, `tags`, `durationSeconds`. Pastikan score diklem 0..100 dan success threshold configurable dari config.</action>
  <verify>Review return object `RunMiniGame` selalu memiliki key kontrak wajib.</verify>
  <done>Caller menerima result object seragam untuk semua mini-game.</done>
</task>

<task type="auto">
  <name>Task 3: Tambah helper API registry + remote name placeholder</name>
  <files>src/ServerScriptService/Services/MiniGameService.lua, src/ReplicatedStorage/Shared/Remotes/RemoteNames.lua</files>
  <action>Tambahkan API helper seperti `HasMiniGame`, `GetMiniGameConfig`, `ListMiniGames` untuk dipakai service lain. Pastikan remote name placeholder mini-game result/event tersedia untuk integrasi phase berikutnya.</action>
  <verify>API helper ada dan remote names baru tidak menghapus nama existing.</verify>
  <done>Kontrak service lebih mudah diintegrasikan dengan anomaly/event/UI pipeline.</done>
</task>

</tasks>

<verification>
- [ ] CookNoodle, RepairComputer, AnomalyResponse punya jalur handler terpisah.
- [ ] Result mini-game seragam dan tervalidasi.
- [ ] Unknown miniGameId aman (warning + nil).
</verification>

<success_criteria>
- Kontrak mini-game tidak ambigu untuk caller lain.
- Fondasi registry siap dipakai anomaly scheduler di plan berikutnya.
</success_criteria>

<output>
After completion, create `.planning/phases/03-mini-game-and-anomaly-events/03-01-SUMMARY.md`
</output>
